<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spanish Birth Registration Form (English Input, Spanish Export)</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for better readability and PDF-like appearance */
        body {
            font-family: 'Inter', sans-serif; /* Using Inter font as per instructions */
            background-color: #f0f4f8; /* Light background */
            display: flex;
            justify-content: center;
            padding: 2rem 0;
            line-height: 1.5; /* Improved line height for readability */
        }
        .form-container {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 0.75rem; /* Rounded corners */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 800px; /* Max width for better form layout */
            width: 100%; /* Fluid width */
            margin: 0 1rem; /* Margin on smaller screens */
            box-sizing: border-box; /* Include padding in width */
        }
        .section-title {
            font-size: 1.5rem; /* Larger font for section titles */
            font-weight: 700; /* Bold */
            color: #1e3a8a; /* Dark blue color */
            margin-bottom: 1.5rem;
            text-align: center;
            border-bottom: 2px solid #bfdbfe; /* Subtle underline */
            padding-bottom: 0.5rem;
        }
        .subsection-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #3b82f6; /* Medium blue color */
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 1px dashed #93c5fd; /* Dashed underline */
            padding-bottom: 0.3rem;
        }
        .form-group {
            margin-bottom: 1rem;
        }
        .form-group label {
            display: block;
            font-weight: 500;
            color: #334155; /* Slightly dark gray for labels */
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }
        .form-group input[type="text"],
        .form-group input[type="date"],
        .form-group input[type="time"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #cbd5e1; /* Light gray border */
            border-radius: 0.375rem; /* Slightly rounded corners */
            font-size: 1rem;
            color: #1f2937; /* Dark text */
            box-sizing: border-box; /* Include padding in width */
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #3b82f6; /* Blue focus border */
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.25); /* Blue glow on focus */
            outline: none;
        }
        .grid-layout {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(1, minmax(0, 1fr)); /* Single column by default */
        }
        @media (min-width: 640px) { /* Small screens and up */
            .grid-layout {
                grid-template-columns: repeat(2, minmax(0, 1fr)); /* Two columns */
            }
            .grid-layout.three-cols {
                grid-template-columns: repeat(3, minmax(0, 1fr)); /* Three columns */
            }
        }
        @media (min-width: 768px) { /* Medium screens and up */
            .grid-layout {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
            .grid-layout.three-cols {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }
        .full-width {
            grid-column: span 1; /* Occupy full width in grid */
        }
        @media (min-width: 640px) {
            .full-width-sm {
                grid-column: span 2;
            }
            .full-width-sm.three-cols {
                grid-column: span 3;
            }
        }
        .radio-group {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }
        .radio-group input[type="radio"] {
            margin-right: 0.5rem;
        }
        .radio-group label {
            display: inline-flex;
            align-items: center;
            font-weight: normal;
        }
        .notes {
            background-color: #e0f2fe; /* Light blue for notes */
            border-left: 5px solid #2196f3; /* Blue left border */
            padding: 1rem 1.25rem;
            margin-top: 2rem;
            border-radius: 0.5rem;
            color: #0c4a6e; /* Darker blue text */
        }
        .notes p {
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }
        .notes ul {
            list-style-type: disc;
            margin-left: 1.25rem;
        }
        .notes li {
            margin-bottom: 0.25rem;
        }
        .signature-box {
            border: 1px solid #cbd5e1;
            min-height: 5rem;
            width: 100%;
            margin-top: 1rem;
            border-radius: 0.375rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
            font-style: italic;
        }
        .form-footer {
            margin-top: 2rem;
            font-size: 0.9rem;
            color: #64748b;
            text-align: center;
        }
        .instruction-section {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 2px dashed #bfdbfe;
        }
        .export-button {
            display: block;
            width: fit-content;
            margin: 2rem auto 0 auto;
            padding: 1rem 2rem;
            background-color: #10b981; /* Green button */
            color: white;
            font-weight: bold;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1.1rem;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem; /* Space between buttons */
        }
        .export-button:hover {
            background-color: #059669; /* Darker green on hover */
            transform: translateY(-2px);
        }
        .export-button:active {
            background-color: #047857;
            transform: translateY(0);
            box-shadow: none;
        }
        .export-buttons-container, .language-buttons-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 2rem;
            align-items: center;
            padding-bottom: 1rem;
        }
        @media (min-width: 640px) {
            .export-buttons-container, .language-buttons-container {
                flex-direction: row;
                justify-content: center;
            }
            .export-button, .language-button {
                margin: 0 0.5rem;
            }
        }
        .language-button {
            display: block;
            width: fit-content;
            padding: 0.75rem 1.5rem;
            background-color: #60a5fa; /* Blue button */
            color: white;
            font-weight: bold;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .language-button:hover {
            background-color: #3b82f6;
            transform: translateY(-1px);
        }
        .language-button:active {
            background-color: #2563eb;
            transform: translateY(0);
            box-shadow: none;
        }

        /* Style for temporary content visibility during PDF generation */
        .pdf-temp-content {
            display: block; /* Ensures it takes up the block space */
            padding: 0.75rem; /* Match input padding */
            font-size: 1rem; /* Match input font size */
            color: #1f2937; /* Match input text color */
            min-height: 2.75rem; /* Ensure consistent height with inputs */
            box-sizing: border-box; /* Include padding in width */
            border: 1px solid #cbd5e1; /* Match input border */
            border-radius: 0.375rem; /* Match input border-radius */
            background-color: #f8fafc; /* Slightly different background to indicate it's text */
            width: 100%; /* Ensure it takes full width of parent */
            line-height: 1.25; /* Adjust line height for better text fit in box */
            word-wrap: break-word; /* Allow long words to break */
        }
        /* Hide original inputs during PDF generation */
        .hide-for-pdf {
            display: none !important;
        }
    </style>
    <!-- jsPDF and html2canvas libraries for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div class="form-container" id="formContainer">
        <header class="text-center mb-6">
            <h1 class="text-lg font-bold text-gray-800" data-en="SPANISH CONSULAR SERVICE" data-es="SERVICIO CONSULAR DE ESPAÑA">SPANISH CONSULAR SERVICE</h1>
            <h2 class="text-xl font-extrabold text-blue-700 mt-2" data-en="CONSULAR CIVIL REGISTRY OF SPAIN IN" data-es="REGISTRO CIVIL CONSULAR DE ESPAÑA EN">CONSULAR CIVIL REGISTRY OF SPAIN IN</h2>
            <h3 class="text-3xl font-black text-gray-900 mt-4" data-en="CIVIL REGISTRY" data-es="REGISTRO CIVIL">CIVIL REGISTRY</h3>
        </header>

        <section class="mb-8">
            <p class="text-lg font-semibold text-center mb-4" data-en="Section I. BIRTHS" data-es="Sección I. NACIMIENTOS">Section I. BIRTHS</p>
            <p class="text-xl font-bold text-center text-blue-600" data-en="(Declaration of data for registration)" data-es="(Declaración de datos para la inscripción)">(Declaration of data for registration)</p>
            <p class="text-sm italic text-center mt-4 text-red-600" data-en="Important note: Before filling out, see instructions on the back (below)." data-es="Nota importante: Antes de cumplimentar ver instrucciones al dorso.">Important note: Before filling out, see instructions on the back (below).</p>
        </section>

        <div class="language-buttons-container">
            <button class="language-button" onclick="toggleLanguage('es')">Traducir al Español</button>
            <button class="language-button" onclick="toggleLanguage('en')">Revertir al Inglés</button>
        </div>

        <section id="birth-data-section">
            <div class="subsection-title" data-en="BIRTH DATA" data-es="DATOS DEL NACIDO">BIRTH DATA</div>
            <div class="grid-layout">
                <div class="form-group">
                    <label for="born-name" data-en="Name (1)" data-es="Nombre (1)">Name (1)</label>
                    <input type="text" id="born-name" name="bornName" placeholder="First Name(s)" data-en-placeholder="First Name(s)" data-es-placeholder="Primer(os) Nombre(s)">
                </div>
                <div class="form-group">
                    <label for="born-first-surname" data-en="First Surname" data-es="Primer Apellido">First Surname</label>
                    <input type="text" id="born-first-surname" name="bornFirstSurname" placeholder="Father's or first surname" data-en-placeholder="Father's or first surname" data-es-placeholder="Apellido del padre o primer apellido">
                </div>
                <div class="form-group">
                    <label for="born-second-surname" data-en="Second Surname (2)" data-es="Segundo Apellido (2)">Second Surname (2)</label>
                    <input type="text" id="born-second-surname" name="bornSecondSurname" placeholder="Mother's or second surname" data-en-placeholder="Mother's or second surname" data-es-placeholder="Apellido de la madre o segundo apellido">
                </div>
                <div class="form-group">
                    <label for="born-sex" data-en="Sex" data-es="Sexo">Sex</label>
                    <div class="radio-group" id="born-sex-radio-group">
                        <label><input type="radio" name="bornSex" value="male"> <span data-en="Male" data-es="Masculino">Male</span></label>
                        <label><input type="radio" name="bornSex" value="female"> <span data-en="Female" data-es="Femenino">Female</span></label>
                        <label><input type="radio" name="bornSex" value="other"> <span data-en="Other" data-es="Otro">Other</span></label>
                    </div>
                </div>
            </div>

            <div class="subsection-title" data-en="BIRTH DETAILS" data-es="DATOS DEL NACIMIENTO">BIRTH DETAILS</div>
            <div class="grid-layout three-cols">
                <div class="form-group">
                    <label for="birth-hour" data-en="Hour" data-es="Hora">Hour</label>
                    <input type="time" id="birth-hour" name="birthHour">
                </div>
                <div class="form-group">
                    <label for="birth-day" data-en="Day (3)" data-es="Día (3)">Day (3)</label>
                    <input type="text" id="birth-day" name="birthDay" placeholder="e.g., 'Seventh'" data-en-placeholder="e.g., 'Seventh'" data-es-placeholder="Ej: 'Séptimo'">
                </div>
                <div class="form-group">
                    <label for="birth-month" data-en="Month" data-es="Mes">Month</label>
                    <input type="text" id="birth-month" name="birthMonth" placeholder="e.g., 'January'" data-en-placeholder="e.g., 'January'" data-es-placeholder="Ej: 'Enero'">
                </div>
                <div class="form-group full-width-sm three-cols">
                    <label for="birth-year" data-en="Year" data-es="Año">Year</label>
                    <input type="text" id="birth-year" name="birthYear" placeholder="e.g., 'Two thousand and twenty-four'" data-en-placeholder="e.g., 'Two thousand and twenty-four'" data-es-placeholder="Ej: 'Dos mil veinticuatro'">
                </div>
                <div class="form-group full-width-sm three-cols">
                    <label for="birth-place" data-en="Place (4)" data-es="Lugar (4)">Place (4)</label>
                    <input type="text" id="birth-place" name="birthPlace" placeholder="Locality, District, Province, State" data-en-placeholder="Locality, District, Province, State" data-es-placeholder="Localidad, Distrito, Provincia, Estado">
                </div>
            </div>

            <div class="grid-layout three-cols mt-4">
                <div class="form-group full-width-sm three-cols">
                    <label for="registered-date" data-en="Registered on (Date)" data-es="Inscrito con fecha">Registered on (Date)</label>
                    <input type="date" id="registered-date" name="registeredDate">
                </div>
                <div class="form-group full-width-sm three-cols">
                    <label for="registered-local-registry" data-en="in the Local Registry of" data-es="En el Registro local de">in the Local Registry of</label>
                    <input type="text" id="registered-local-registry" name="registeredLocalRegistry" placeholder="Local Registry Name" data-en-placeholder="Local Registry Name" data-es-placeholder="Nombre del Registro local">
                </div>
                <div class="form-group">
                    <label for="registered-volume" data-en="in Volume" data-es="En el Tomo">in Volume</label>
                    <input type="text" id="registered-volume" name="registeredVolume">
                </div>
                <div class="form-group">
                    <label for="registered-page" data-en="Page" data-es="Página">Page</label>
                    <input type="text" id="registered-page" name="registeredPage">
                </div>
                <div class="form-group">
                    <label for="registered-number" data-en="No." data-es="Núm.">No.</label>
                    <input type="text" id="registered-number" name="registeredNumber">
                </div>
            </div>
        </section>

        <section id="father-data-section">
            <div class="subsection-title" data-en="FATHER'S DATA (5)" data-es="DATOS DEL PADRE (5)">FATHER'S DATA (5)</div>
            <div class="grid-layout">
                <div class="form-group">
                    <label for="father-name" data-en="Name" data-es="Nombre">Name</label>
                    <input type="text" id="father-name" name="fatherName">
                </div>
                <div class="form-group">
                    <label for="father-first-surname" data-en="First Surname" data-es="Primer Apellido">First Surname</label>
                    <input type="text" id="father-first-surname" name="fatherFirstSurname">
                </div>
                <div class="form-group full-width">
                    <label for="father-second-surname" data-en="Second Surname" data-es="Segundo Apellido">Second Surname</label>
                    <input type="text" id="father-second-surname" name="fatherSecondSurname">
                </div>
                <div class="form-group full-width">
                    <label for="father-parentage" data-en="Son of" data-es="Hijo de">Son of</label>
                    <input type="text" id="father-parentage" name="fatherParentage" placeholder="Father's Mother's Name and Mother's Father's Name" data-en-placeholder="Father's Mother's Name and Mother's Father's Name" data-es-placeholder="Nombre de la madre del padre y del padre del padre">
                </div>
                <div class="form-group full-width">
                    <label for="father-born-place" data-en="Born in" data-es="Nacido en">Born in</label>
                    <input type="text" id="father-born-place" name="fatherBornPlace">
                </div>
                <div class="form-group">
                    <label for="father-born-day" data-en="on the day" data-es="El día">on the day</label>
                    <input type="date" id="father-born-day" name="fatherBornDay">
                </div>
                <div class="form-group full-width">
                    <label for="father-civil-status-birth" data-en="Civil status at the birth of the child" data-es="Estado civil al nacer el/la hijo/a">Civil status at the birth of the child</label>
                    <input type="text" id="father-civil-status-birth" name="fatherCivilStatusBirth">
                </div>
                <div class="form-group full-width">
                    <label for="father-civil-status-current" data-en="Civil status at present" data-es="Estado civil en el momento actual">Civil status at present</label>
                    <input type="text" id="father-civil-status-current" name="fatherCivilStatusCurrent">
                </div>
                <div class="form-group full-width">
                    <label for="father-nationality-birth" data-en="Nationality at the birth of the child" data-es="Nacionalidad al nacer el/la hijo/a">Nationality at the birth of the child</label>
                    <input type="text" id="father-nationality-birth" name="fatherNationalityBirth">
                </div>
                <div class="form-group full-width">
                    <label for="father-nationality-current" data-en="Nationality at present" data-es="Nacionalidad en el momento actual">Nationality at present</label>
                    <input type="text" id="father-nationality-current" name="fatherNationalityCurrent">
                </div>
                <div class="form-group full-width">
                    <label for="father-address" data-en="Address" data-es="Domicilio">Address</label>
                    <input type="text" id="father-address" name="fatherAddress">
                </div>
                <div class="form-group full-width">
                    <label for="father-dni" data-en="D.N.I. (National Identity Document)" data-es="D. N. I.">D.N.I. (National Identity Document)</label>
                    <input type="text" id="father-dni" name="fatherDni">
                </div>
            </div>
        </section>

        <section id="mother-data-section">
            <div class="subsection-title" data-en="MOTHER'S DATA (5)" data-es="DATOS DE LA MADRE (5)">MOTHER'S DATA (5)</div>
            <div class="grid-layout">
                <div class="form-group">
                    <label for="mother-name" data-en="Name" data-es="Nombre">Name</label>
                    <input type="text" id="mother-name" name="motherName">
                </div>
                <div class="form-group">
                    <label for="mother-first-surname" data-en="First Surname" data-es="Primer Apellido">First Surname</label>
                    <input type="text" id="mother-first-surname" name="motherFirstSurname">
                </div>
                <div class="form-group full-width">
                    <label for="mother-second-surname" data-en="Second Surname" data-es="Segundo Apellido">Second Surname</label>
                    <input type="text" id="mother-second-surname" name="motherSecondSurname">
                </div>
                <div class="form-group full-width">
                    <label for="mother-parentage" data-en="Daughter of" data-es="Hija de">Daughter of</label>
                    <input type="text" id="mother-parentage" name="motherParentage" placeholder="Mother's Mother's Name and Mother's Father's Name" data-en-placeholder="Mother's Mother's Name and Mother's Father's Name" data-es-placeholder="Nombre de la madre de la madre y del padre de la madre">
                </div>
                <div class="form-group full-width">
                    <label for="mother-born-place" data-en="Born in" data-es="Nacida en">Born in</label>
                    <input type="text" id="mother-born-place" name="motherBornPlace">
                </div>
                <div class="form-group">
                    <label for="mother-born-day" data-en="on the day" data-es="El día">on the day</label>
                    <input type="date" id="mother-born-day" name="motherBornDay">
                </div>
                <div class="form-group full-width">
                    <label for="mother-civil-status-birth" data-en="Civil status at the birth of the child" data-es="Estado civil al nacer el/la hijo/a">Civil status at the birth of the child</label>
                    <input type="text" id="mother-civil-status-birth" name="motherCivilStatusBirth">
                </div>
                <div class="form-group full-width">
                    <label for="mother-civil-status-current" data-en="Civil status at present" data-es="Estado civil en el momento actual">Civil status at present</label>
                    <input type="text" id="mother-civil-status-current" name="motherCivilStatusCurrent">
                </div>
                <div class="form-group full-width">
                    <label for="mother-nationality-birth" data-en="Nationality at the birth of the child" data-es="Nacionalidad al nacer el/la hijo/a">Nationality at the birth of the child</label>
                    <input type="text" id="mother-nationality-birth" name="motherNationalityBirth">
                </div>
                <div class="form-group full-width">
                    <label for="mother-nationality-current" data-en="Nationality at present" data-es="Nacionalidad en el momento actual">Nationality at present</label>
                    <input type="text" id="mother-nationality-current" name="motherNationalityCurrent">
                </div>
                <div class="form-group full-width">
                    <label for="mother-address" data-en="Address" data-es="Domicilio">Address</label>
                    <input type="text" id="mother-address" name="motherAddress">
                </div>
                <div class="form-group full-width">
                    <label for="mother-dni" data-en="D.N.I. (National Identity Document)" data-es="D. N. I.">D.N.I. (National Identity Document)</label>
                    <input type="text" id="mother-dni" name="motherDni">
                </div>
            </div>
        </section>

        <div class="form-footer text-right italic mt-8 pb-4 border-b border-gray-300" data-en="Continues on back.../" data-es="Sigue al dorso.../">
            Continues on back.../
        </div>

        <section id="marriage-section" class="mt-8">
            <div class="subsection-title" data-en="PARENTS' MARRIAGE (6)" data-es="MATRIMONIO DE LOS PADRES (6)">PARENTS' MARRIAGE (6)</div>
            <div class="grid-layout">
                <div class="form-group full-width">
                    <label for="marriage-date" data-en="Day of celebration" data-es="Día de la celebración">Day of celebration</label>
                    <input type="date" id="marriage-date" name="marriageDate">
                </div>
                <div class="form-group full-width">
                    <label for="marriage-place" data-en="Place of celebration" data-es="Lugar de celebración">Place of celebration</label>
                    <input type="text" id="marriage-place" name="marriagePlace">
                </div>
                <div class="form-group full-width">
                    <label for="marriage-registered-in" data-en="Registered in" data-es="Inscrito en">Registered in</label>
                    <input type="text" id="marriage-registered-in" name="marriageRegisteredIn">
                </div>
                <div class="form-group full-width">
                    <label for="marriage-document" data-en="Supporting document presented" data-es="Documento acreditativo presentado">Supporting document presented</label>
                    <input type="text" id="marriage-document" name="marriageDocument">
                </div>
            </div>
        </section>

        <section id="observations-section">
            <div class="subsection-title" data-en="OBSERVATIONS (7)" data-es="OBSERVACIONES (7)">OBSERVATIONS (7)</div>
            <div class="form-group">
                <textarea id="observations" name="observations" rows="4" class="w-full" placeholder="Enter any relevant observations here." data-en-placeholder="Enter any relevant observations here." data-es-placeholder="Escriba aquí cualquier observación relevante."></textarea>
            </div>
        </section>

        <section id="declarant-section">
            <div class="subsection-title" data-en="DECLARANT (8)" data-es="DECLARANTE (8)">DECLARANT (8)</div>
            <div class="form-group">
                    <label for="declarant-name" data-en="Mr./Ms." data-es="D./Dª.">Mr./Ms.</label>
                    <input type="text" id="declarant-name" name="declarantName">
                </div>
            <div class="grid-layout">
                <div class="form-group">
                    <label for="declarant-capacity" data-en="In the capacity of" data-es="En calidad de">In the capacity of</label>
                    <input type="text" id="declarant-capacity" name="declarantCapacity" placeholder="e.g., Interested party, father, mother, etc." data-en-placeholder="e.g., Interested party, father, mother, etc." data-es-placeholder="Ej: Interesado, padre, madre, etc.">
                </div>
                <div class="form-group">
                    <label for="declarant-native" data-en="Native of" data-es="Natural de">Native of</label>
                    <input type="text" id="declarant-native" name="declarantNative">
                </div>
                <div class="form-group">
                    <label for="declarant-dob" data-en="Date of birth" data-es="Fecha de nacimiento">Date of birth</label>
                    <input type="date" id="declarant-dob" name="declarantDob">
                </div>
                <div class="form-group">
                    <label for="declarant-pob" data-en="Place of birth" data-es="Lugar de nacimiento">Place of birth</label>
                    <input type="text" id="declarant-pob" name="declarantPob">
                </div>
                <div class="form-group full-width">
                    <label for="declarant-address" data-en="Address" data-es="Domicilio">Address</label>
                    <input type="text" id="declarant-address" name="declarantAddress">
                </div>
                <div class="form-group">
                    <label for="declarant-phone" data-en="Telephone" data-es="Teléfono">Telephone</label>
                    <input type="tel" id="declarant-phone" name="declarantPhone">
                </div>
                <div class="form-group">
                    <label for="declarant-cp" data-en="C.P. (Postal Code)" data-es="C. P.">C.P. (Postal Code)</label>
                    <input type="text" id="declarant-cp" name="declarantCp">
                </div>
                <div class="form-group full-width">
                    <label for="declarant-supporting-doc" data-en="Supporting document" data-es="Documento acreditativo">Supporting document</label>
                    <input type="text" id="declarant-supporting-doc" name="declarantSupportingDoc">
                </div>
            </div>

            <div class="flex flex-col sm:flex-row justify-between items-center mt-6">
                <div class="form-group mb-4 sm:mb-0 w-full sm:w-1/2">
                    <label for="declarant-signature-place" data-en="In" data-es="En">In</label>
                    <input type="text" id="declarant-signature-place" name="declarantSignaturePlace">
                </div>
                <div class="form-group w-full sm:w-1/2 flex justify-end items-center gap-2">
                    <label for="declarant-signature-date" data-en="on" data-es="A">on</label>
                    <input type="date" id="declarant-signature-date" name="declarantSignatureDate" class="w-auto">
                </div>
            </div>
            <div class="form-group mt-4">
                <label for="declarant-signature" data-en="Declarant's signature (9)" data-es="Firma del declarante (9)">Declarant's signature (9)</label>
                <div class="signature-box" data-en-text="Sign here" data-es-text="Firme aquí">
                    <p>Sign here</p>
                </div>
            </div>
        </section>

        <section class="instruction-section">
            <h2 class="section-title" data-en="INSTRUCTIONS" data-es="INSTRUCCIONES">INSTRUCTIONS</h2>
            <div class="notes">
                <p class="font-semibold text-lg mb-2" data-en="Fill in by typewriter or by hand in block letters." data-es="Cumplimentar a máquina o a mano con caracteres de imprenta.">Fill in by typewriter or by hand in block letters.</p>
                <ul>
                    <li><strong class="font-semibold" data-en="(1) Name:" data-es="(1) Nombre:">(1) Name:</strong> <span data-en="Only birth registrations stating two simple names (e.g., José Luis) or one compound name (e.g., María del Carmen) may be performed. Foreign names that have translation into any Spanish language must be entered in the version chosen by the person who is to impose the name (Castilian, Catalan, Basque, Galician, etc.)." data-es="Unicamente se podrán practicar inscripciones de nacimiento haciendo constar dos nombres simples (p. e., José Luis o uno compuesto, María del Carmen). Los nombres extranjeros que tengan traducción a cualquiera de las lenguas españolas deberán consignarse en la versión que elija quien haya de imponer el nombre (castellana, catalana, vasca, gallega, etc.).">Only birth registrations stating two simple names (e.g., José Luis) or one compound name (e.g., María del Carmen) may be performed. Foreign names that have translation into any Spanish language must be entered in the version chosen by the person who is to impose the name (Castilian, Catalan, Basque, Galician, etc.).</span></li>
                    <li><strong class="font-semibold" data-en="(2) Surnames:" data-es="(2) Apellidos:">(2) Surnames:</strong> <span data-en="Birth registrations must be carried out stating two surnames, including those registrations of foreign persons who have acquired Spanish nationality." data-es="Las inscripciones de nacimiento habrán de practicarse haciendo constar dos apellidos, incluso aquellas inscripciones de personas extranjeras que hayan adquirido la nacionalidad española.">Birth registrations must be carried out stating two surnames, including those registrations of foreign persons who have acquired Spanish nationality.</span></li>
                    <li><strong class="font-semibold" data-en="(3) Day:" data-es="(3) Día:">(3) Day:</strong> <span data-en="Enter the data in letters (e.g., 'Seventh')." data-es="Consignar el dato en letra.">Enter the data in letters (e.g., 'Seventh').</span></li>
                    <li><strong class="font-semibold" data-en="(4) Place:" data-es="(4) Lugar:">(4) Place:</strong> <span data-en="Indicate locality, district, province, and State." data-es="Indicar localidad, distrito, provincia y Estado.">Indicate locality, district, province, and State.</span></li>
                    <li><strong class="font-semibold" data-en="(5) Parent Data:" data-es="(5) Datos de los Padres:">(5) Parent Data:</strong> <span data-en="In the case of non-marital filiation, the progenitor requesting the registration shall not state the name of the other progenitor, unless the filiation has already been established with respect to the latter, in which case it must be documented. In the case of unknown filiation, the names of the father and mother will be stated for identification purposes only." data-es="En caso de tratarse de filiación no matrimonial, el progenitor que solicite la inscripción no manifestará el nombre del otro progenitor, a no ser que la filiación ya estuviera establecida respecto de éste, en cuyo caso deberá ser acreditada documentalmente. En el supuesto de filiación desconocida se harán constar nombres de padre y madre a los solos efectos identificadores.">In the case of non-marital filiation, the progenitor requesting the registration shall not state the name of the other progenitor, unless the filiation has already been established with respect to the latter, in which case it must be documented. In the case of unknown filiation, the names of the father and mother will be stated for identification purposes only.</span></li>
                    <li><strong class="font-semibold" data-en="(6) Parents' Marriage:" data-es="(6) Matrimonio de los Padres:">(6) Parents' Marriage:</strong> <span data-en="Indicate &quot;Exists&quot; or &quot;Does Not Exist&quot; if parents were married." data-es="Indicar «Existe» o «No Existe».">Indicate "Exists" or "Does Not Exist" if parents were married.</span></li>
                    <li><strong class="font-semibold" data-en="(7) Observations:" data-es="(7) Observaciones:">(7) Observations:</strong> <span data-en="In case of multiple birth, the order of birth will be stated here." data-es="En caso de parto múltiple se consignará el orden de nacimiento.">In case of multiple birth, the order of birth will be stated here.</span></li>
                    <li><strong class="font-semibold" data-en="(8) Declarant:" data-es="(8) Declarante:">(8) Declarant:</strong> <span data-en="This refers to the Interested party, father, mother, etc." data-es="Interesado, padre, madre, etc.">This refers to the Interested party, father, mother, etc.</span></li>
                    <li><strong class="font-semibold" data-en="(9) Signature:" data-es="(9) Firma:">(9) Signature:</strong> <span data-en="If unable or unwilling to sign, two witnesses will do so at their request, who will state their name, two surnames, and address clearly legible below the signature." data-es="Si no pudiere o no supiere firmar, lo harán a su ruego dos testigos, los cuales harán constar debajo de la firma, en caracteres bien legibles, su nombre, dos apellidos y domicilio.">If unable or unwilling to sign, two witnesses will do so at their request, who will state their name, two surnames, and address clearly legible below the signature.</span></li>
                </ul>
                <p class="mt-4 font-bold text-sm" data-en="NOTE: The submission of titles for registration by third parties is permitted. However, the Civil Registry is not obliged to maintain correspondence or inform them, unless they are duly authorized in writing. In the event that the initiation of the procedure is promoted, it can only be initiated by the interested parties themselves or by lawyers or attorneys expressly authorized for this purpose." data-es="NOTA: Se admite la presentación de títulos para la inscripción por terceras personas. No obstante el Registro Civil no está obligado a mantener correspondencia ni a informar a los mismos, salvo que estuvieran apoderados por escrito. En el supuesto de que se promueva la incoación del expediente, éste sólo puede ser instado por los propios interesados o por abogados o procuradores expresamente apoderados al efecto.">
                    NOTE: The submission of titles for registration by third parties is permitted. However, the Civil Registry is not obliged to maintain correspondence or inform them, unless they are duly authorized in writing. In the Event that the initiation of the procedure is promoted, it can only be initiated by the interested parties themselves or by lawyers or attorneys expressly authorized for this purpose.
                </p>
            </div>
        </section>

        <div class="language-buttons-container">
            <button class="language-button" onclick="toggleLanguage('es')">Traducir al Español</button>
            <button class="language-button" onclick="toggleLanguage('en')">Revertir al Inglés</button>
        </div>

        <div class="export-buttons-container">
            <button class="export-button" onclick="exportFormAsPdf()">Export Form as PDF (Image-based)</button>
            <button class="export-button" onclick="exportFormAsText()">Export Data as Text</button>
        </div>

    </div>

    <script>
        // Store current display language state
        let currentDisplayLanguage = 'en'; // Default is English

        // Map for translation of static texts on the form
        // Data attributes (data-en, data-es, data-en-placeholder, data-es-placeholder, data-en-text, data-es-text)
        // are used directly in the HTML for most static elements.
        // This 'labelTranslations' object is specifically for generating the TXT export.
        const labelTranslations = {
            // Section Titles (for TXT export structure)
            'SPANISH CONSULAR SERVICE': 'SERVICIO CONSULAR DE ESPAÑA',
            'CONSULAR CIVIL REGISTRY OF SPAIN IN': 'REGISTRO CIVIL CONSULAR DE ESPAÑA EN',
            'CIVIL REGISTRY': 'REGISTRO CIVIL',
            'Section I. BIRTHS': 'Sección I. NACIMIENTOS',
            '(Declaration of data for registration)': '(Declaración de datos para la inscripción)',
            'Important note: Before filling out, see instructions on the back (below).': 'Nota importante: Antes de cumplimentar ver instrucciones al dorso.',
            'BIRTH DATA': 'DATOS DEL NACIDO',
            'BIRTH DETAILS': 'DATOS DEL NACIMIENTO',
            'FATHER\'S DATA (5)': 'DATOS DEL PADRE (5)',
            'MOTHER\'S DATA (5)': 'DATOS DE LA MADRE (5)',
            'Continues on back.../': 'Sigue al dorso.../',
            'PARENTS\' MARRIAGE (6)': 'MATRIMONIO DE LOS PADRES (6)',
            'OBSERVATIONS (7)': 'OBSERVACIONES (7)',
            'DECLARANT (8)': 'DECLARANTE (8)',
            'INSTRUCTIONS': 'INSTRUCCIONES',
            'Fill in by typewriter or by hand in block letters.': 'Cumplimentar a máquina o a mano con caracteres de imprenta.',
            '(1) Name:': '(1) Nombre:',
            'Only birth registrations stating two simple names (e.g., José Luis) or one compound name (e.g., María del Carmen) may be performed. Foreign names that have translation into any Spanish language must be entered in the version chosen by the person who is to impose the name (Castilian, Catalan, Basque, Galician, etc.).': 'Unicamente se podrán practicar inscripciones de nacimiento haciendo constar dos nombres simples (p. e., José Luis o uno compuesto, María del Carmen). Los nombres extranjeros que tengan traducción a cualquiera de las lenguas españolas deberán consignarse en la versión que elija quien haya de imponer el nombre (castellana, catalana, vasca, gallega, etc.).',
            '(2) Surnames:': '(2) Apellidos:',
            'Birth registrations must be carried out stating two surnames, including those registrations of foreign persons who have acquired Spanish nationality.': 'Las inscripciones de nacimiento habrán de practicarse haciendo constar dos apellidos, incluso aquellas inscripciones de personas extranjeras que hayan adquirido la nacionalidad española.',
            '(3) Day:': '(3) Día:',
            'Enter the data in letters (e.g., \'Seventh\').': 'Consignar el dato en letra.',
            '(4) Place:': '(4) Lugar:',
            'Indicate locality, district, province, and State.': 'Indicar localidad, distrito, provincia y Estado.',
            '(5) Parent Data:': '(5) Datos de los Padres:',
            'In the case of non-marital filiation, the progenitor requesting the registration shall not state the name of the other progenitor, unless the filiation has already been established with respect to the latter, in which case it must be documented. In the case of unknown filiation, the names of the father and mother will be stated for identification purposes only.': 'En caso de tratarse de filiación no matrimonial, el progenitor que solicite la inscripción no manifestará el nombre del otro progenitor, a no ser que la filiación ya estuviera establecida respecto de éste, en cuyo caso deberá ser acreditada documentalmente. En el supuesto de filiación desconocida se harán constar nombres de padre y madre a los solos efectos identificadores.',
            '(6) Parents\' Marriage:': '(6) Matrimonio de los Padres:',
            'Indicate "Exists" or "Does Not Exist" if parents were married.': 'Indicar «Existe» o «No Existe».',
            '(7) Observations:': '(7) Observaciones:',
            'In case of multiple birth, the order of birth will be stated here.': 'En caso de parto múltiple se consignará el orden de nacimiento.',
            '(8) Declarant:': '(8) Declarante:',
            'This refers to the Interested party, father, mother, etc.': 'Interesado, padre, madre, etc.',
            '(9) Signature:': '(9) Firma:',
            'If unable or unwilling to sign, two witnesses will do so at their request, who will state their name, two surnames, and address clearly legible below the signature.': 'Si no pudiere o no supiere firmar, lo harán a su ruego dos testigos, los cuales harán constar debajo de la firma, en caracteres bien legibles, su nombre, dos apellidos y domicilio.',
            'NOTE: The submission of titles for registration by third parties is permitted. However, the Civil Registry is not obliged to maintain correspondence or inform them, unless they are duly authorized in writing. In the event that the initiation of the procedure is promoted, it can only be initiated by the interested parties themselves or by lawyers or attorneys expressly authorized for this purpose.': 'NOTA: Se admite la presentación de títulos para la inscripción por terceras personas. No obstante el Registro Civil no está obligado a mantener correspondencia ni a informar a los mismos, salvo que estuvieran apoderados por escrito. En el supuesto de que se promueva la incoación del expediente, éste sólo puede ser instado por los propios interesados o por abogados o procuradores expresamente apoderados al efecto.',


            // Field Labels (for TXT export, matching the HTML `for` attributes or `name` attributes)
            'born-name': 'Nombre (1)',
            'born-first-surname': 'Primer Apellido',
            'born-second-surname': 'Segundo Apellido (2)',
            'bornSex': {
                'group_label': 'Sexo',
                'male': 'Masculino',
                'female': 'Femenino',
                'other': 'Otro'
            },
            'birth-hour': 'Hora',
            'birth-day': 'Día (3)',
            'birth-month': 'Mes',
            'birth-year': 'Año',
            'birth-place': 'Lugar (4)',
            'registered-date': 'Inscrito con fecha',
            'registered-local-registry': 'En el Registro local de',
            'registered-volume': 'En el Tomo',
            'registered-page': 'Página',
            'registered-number': 'Núm.',

            'father-name': 'Nombre',
            'father-first-surname': 'Primer Apellido',
            'father-second-surname': 'Segundo Apellido',
            'father-parentage': 'Hijo de',
            'father-born-place': 'Nacido en',
            'father-born-day': 'El día',
            'father-civil-status-birth': 'Estado civil al nacer el/la hijo/a',
            'father-civil-status-current': 'Estado civil en el momento actual',
            'father-nationality-birth': 'Nacionalidad al nacer el/la hijo/a',
            'father-nationality-current': 'Nacionalidad en el momento actual',
            'father-address': 'Domicilio',
            'father-dni': 'D. N. I.',

            'mother-name': 'Nombre',
            'mother-first-surname': 'Primer Apellido',
            'mother-second-surname': 'Segundo Apellido',
            'mother-parentage': 'Hija de',
            'mother-born-place': 'Nacida en',
            'mother-born-day': 'El día',
            'mother-civil-status-birth': 'Estado civil al nacer el/la hijo/a',
            'mother-civil-status-current': 'Estado civil en el momento actual',
            'mother-nationality-birth': 'Nacionalidad al nacer el/la hijo/a',
            'mother-nationality-current': 'Nacionalidad en el momento actual',
            'mother-address': 'Domicilio',
            'mother-dni': 'D. N. I.',

            'marriage-date': 'Día de la celebración',
            'marriage-place': 'Lugar de celebración',
            'marriage-registered-in': 'Inscrito en',
            'marriage-document': 'Documento acreditativo presentado',

            'observations': 'OBSERVACIONES',

            'declarant-name': 'D./Dª.',
            'declarant-capacity': 'En calidad de',
            'declarant-native': 'Natural de',
            'declarant-dob': 'Fecha de nacimiento',
            'declarant-pob': 'Lugar de nacimiento',
            'declarant-address': 'Domicilio',
            'declarant-phone': 'Teléfono',
            'declarant-cp': 'C. P.',
            'declarant-supporting-doc': 'Documento acreditativo',
            'declarant-signature-place': 'En',
            'declarant-signature-date': 'A',
            'declarant-signature': 'Firma del declarante (9)'
        };

        /**
         * Toggles the language of the static text elements on the form.
         * @param {string} lang 'en' for English, 'es' for Spanish.
         */
        function toggleLanguage(lang) {
            const elementsToTranslate = document.querySelectorAll('[data-en], [data-es], [data-en-placeholder], [data-es-placeholder], [data-en-text], [data-es-text]');

            elementsToTranslate.forEach(el => {
                // Handle text content
                if (el.hasAttribute(`data-${lang}`)) {
                    // Only update textContent if it's different to prevent unnecessary DOM changes
                    if (el.textContent.trim() !== el.getAttribute(`data-${lang}`).trim()) {
                         // For elements that are not input fields, or part of the radio label span
                        if (!el.tagName.includes('INPUT') && !el.tagName.includes('TEXTAREA') && !el.tagName.includes('SELECT') && el.tagName !== 'SPAN') {
                            el.textContent = el.getAttribute(`data-${lang}`);
                        } else if (el.tagName === 'SPAN' && el.closest('.radio-group')) {
                            // Handle spans within radio labels specifically
                            el.textContent = el.getAttribute(`data-${lang}`);
                        }
                    }
                }

                // Handle placeholder text for inputs
                if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                    if (el.hasAttribute(`data-${lang}-placeholder`)) {
                        el.setAttribute('placeholder', el.getAttribute(`data-${lang}-placeholder`));
                    }
                }

                // Handle specific text for elements like signature box <p>
                if (el.hasAttribute(`data-${lang}-text`)) {
                    el.textContent = el.getAttribute(`data-${lang}-text`);
                }
            });
            currentDisplayLanguage = lang; // Update the global language state
        }


        /**
         * Prepares the form for export by temporarily switching to Spanish labels and replacing inputs with their values.
         * Then executes the provided callback, and finally restores the original display language.
         * @param {Function} callback - The function to execute after preparation (e.g., PDF generation or text extraction).
         */
        async function prepareFormForExport(callback) {
            const formContainer = document.getElementById('formContainer');
            const originalElements = [];
            const tempElements = [];

            // 1. Temporarily switch static texts to Spanish for export
            const elementsToTranslate = formContainer.querySelectorAll('[data-en], [data-es], [data-en-placeholder], [data-es-placeholder], [data-en-text], [data-es-text]');

            elementsToTranslate.forEach(el => {
                if (el.hasAttribute('data-es')) {
                    originalElements.push({ element: el, type: 'text-content', originalContent: el.textContent });
                    el.textContent = el.getAttribute('data-es');
                }
                if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                    if (el.hasAttribute('data-es-placeholder')) {
                        originalElements.push({ element: el, type: 'placeholder', originalPlaceholder: el.getAttribute('placeholder') });
                        el.setAttribute('placeholder', el.getAttribute('data-es-placeholder'));
                    }
                }
                if (el.hasAttribute('data-es-text')) {
                    originalElements.push({ element: el, type: 'inner-text', originalContent: el.textContent });
                    el.textContent = el.getAttribute('data-es-text');
                }
            });

            // 2. Hide input fields and display their values as text (for PDF capture)
            const inputsToTransform = formContainer.querySelectorAll('input:not([type="radio"]), select, textarea');
            inputsToTransform.forEach(input => {
                const tempSpan = document.createElement('span');
                tempSpan.classList.add('pdf-temp-content');

                let displayValue = '';
                if (input.tagName === 'SELECT') {
                    displayValue = input.options[input.selectedIndex].text;
                } else {
                    displayValue = input.value;
                }

                tempSpan.textContent = displayValue === '' ? ' ' : displayValue;
                input.parentNode.insertBefore(tempSpan, input);
                tempElements.push(tempSpan);

                originalElements.push({ element: input, type: 'input', display: input.style.display });
                input.classList.add('hide-for-pdf');
            });

            // 3. Handle radio button groups
            const radioGroups = {};
            formContainer.querySelectorAll('input[type="radio"]').forEach(radio => {
                const groupName = radio.name;
                if (!radioGroups[groupName]) {
                    radioGroups[groupName] = {
                        selected: null,
                        groupElement: document.getElementById(groupName + '-radio-group'),
                        allRadios: []
                    };
                }
                radioGroups[groupName].allRadios.push(radio);
                if (radio.checked) {
                    radioGroups[groupName].selected = radio;
                }
            });

            for (const groupName in radioGroups) {
                const group = radioGroups[groupName];
                const radioGroupContainer = group.groupElement;

                if (radioGroupContainer) {
                    const tempSpan = document.createElement('span');
                    tempSpan.classList.add('pdf-temp-content');

                    if (group.selected) {
                        const originalRadioLabelSpan = radioGroupContainer.querySelector(`label input[name="${groupName}"][value="${group.selected.value}"] span`);
                        const spanishRadioValue = originalRadioLabelSpan ? originalRadioLabelSpan.getAttribute('data-es') : group.selected.value;
                        tempSpan.textContent = spanishRadioValue;
                    } else {
                        tempSpan.textContent = ' ';
                    }

                    radioGroupContainer.parentNode.insertBefore(tempSpan, radioGroupContainer);
                    tempElements.push(tempSpan);

                    originalElements.push({ element: radioGroupContainer, type: 'group', display: radioGroupContainer.style.display });
                    radioGroupContainer.classList.add('hide-for-pdf');
                }
            }

            // 4. Temporarily hide the export/language buttons container
            const buttonsContainer = document.querySelector('.export-buttons-container');
            const langButtonsContainers = document.querySelectorAll('.language-buttons-container'); // Select all instances
            
            if (buttonsContainer) {
                originalElements.push({ element: buttonsContainer, type: 'button-container', display: buttonsContainer.style.display });
                buttonsContainer.classList.add('hide-for-pdf');
            }
            langButtonsContainers.forEach(container => {
                if (container) {
                    originalElements.push({ element: container, type: 'button-container', display: container.style.display });
                    container.classList.add('hide-for-pdf');
                }
            });


            // Execute the callback function (e.g., PDF generation)
            await callback();

            // 5. Restore original HTML elements
            originalElements.forEach(item => {
                if (item.type === 'text-content') {
                    item.element.textContent = item.originalContent;
                } else if (item.type === 'placeholder') {
                    item.element.setAttribute('placeholder', item.originalPlaceholder);
                } else if (item.type === 'inner-text') {
                    item.element.textContent = item.originalContent;
                }
                else {
                    item.element.classList.remove('hide-for-pdf');
                    item.element.style.display = item.display;
                }
            });
            tempElements.forEach(span => span.remove()); // Remove temporary spans

            // Reapply the language that was active before export
            toggleLanguage(currentDisplayLanguage);
        }


        /**
         * @function exportFormAsPdf
         * @description Initiates the process to capture the form with Spanish labels and English inputs,
         * then generates a multi-page PDF.
         */
        async function exportFormAsPdf() {
            await prepareFormForExport(async () => {
                const formContainer = document.getElementById('formContainer');
                try {
                    const canvas = await html2canvas(formContainer, {
                        scale: 2,
                        useCORS: true,
                        windowWidth: formContainer.scrollWidth,
                        windowHeight: formContainer.scrollHeight
                    });

                    const imgData = canvas.toDataURL('image/png');
                    const { jsPDF } = window.jspdf;

                    const pdf = new jsPDF({
                        orientation: 'portrait',
                        unit: 'px',
                        format: 'a4'
                    });

                    const imgWidth = pdf.internal.pageSize.getWidth();
                    const pageHeight = pdf.internal.pageSize.getHeight();
                    const imgHeight = canvas.height * imgWidth / canvas.width;

                    let heightLeft = imgHeight;
                    let position = 0;

                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;

                    while (heightLeft > 0) {
                        pdf.addPage();
                        position = - (imgHeight - heightLeft);
                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                    }

                    pdf.save('Formulario_Nacimiento_Ciudadania_España_Cumplimentado.pdf');

                } catch (error) {
                    console.error("Error al generar PDF:", error);
                }
            });
        }

        /**
         * @function exportFormAsText
         * @description Gathers all form data with Spanish labels and exports it as a plain text file,
         * allowing the user to copy and paste the content.
         */
        function exportFormAsText() {
            let formData = '';
            const formContainer = document.getElementById('formContainer');
            const processedRadioGroups = new Set(); // To prevent duplicate processing of radio groups

            // Helper to get Spanish text from data-es attributes for static elements
            const getSpanishText = (selector) => {
                const el = document.querySelector(selector);
                return el && el.hasAttribute('data-es') ? el.getAttribute('data-es').trim() : '';
            };

            // Helper to get Spanish text for labels, including fallbacks
            const getFieldLabelSpanish = (inputElement) => {
                const inputId = inputElement.id || inputElement.name;
                if (labelTranslations[inputId] && typeof labelTranslations[inputId] === 'string') {
                    return labelTranslations[inputId];
                } else if (labelTranslations[inputId] && typeof labelTranslations[inputId] === 'object' && labelTranslations[inputId].group_label) {
                    return labelTranslations[inputId].group_label;
                } else {
                    const labelEl = document.querySelector(`label[for="${inputElement.id}"]`);
                    if (labelEl && labelEl.hasAttribute('data-es')) {
                        return labelEl.getAttribute('data-es');
                    } else if (inputElement.hasAttribute('data-es-placeholder')) {
                        return inputElement.getAttribute('data-es-placeholder');
                    }
                }
                return inputId || ''; // Fallback to ID/name if no translation found
            };

            // --- Header Section ---
            formData += getSpanishText('h1[data-es]') + '\n';
            formData += getSpanishText('h2[data-es]') + '\n';
            formData += getSpanishText('h3[data-es]') + '\n\n';
            formData += getSpanishText('section:nth-of-type(2) p:nth-of-type(1)[data-es]') + '\n';
            formData += getSpanishText('section:nth-of-type(2) p:nth-of-type(2)[data-es]') + '\n';
            formData += getSpanishText('section:nth-of-type(2) p:nth-of-type(3)[data-es]') + '\n\n';


            // --- Iterate through form sections and fields ---
            const sectionsToProcess = [
                { selector: '#birth-data-section', titleKey: 'BIRTH DATA' },
                { selector: '#father-data-section', titleKey: 'FATHER\'S DATA (5)' },
                { selector: '#mother-data-section', titleKey: 'MOTHER\'S DATA (5)' },
                { selector: '#marriage-section', titleKey: 'PARENTS\' MARRIAGE (6)' },
                { selector: '#observations-section', titleKey: 'OBSERVATIONS (7)' },
                { selector: '#declarant-section', titleKey: 'DECLARANT (8)' }
            ];

            sectionsToProcess.forEach(sectionInfo => {
                const sectionElement = document.querySelector(sectionInfo.selector);
                if (!sectionElement) return;

                const sectionTitleEl = sectionElement.querySelector('.subsection-title');
                let sectionTitle = sectionTitleEl && sectionTitleEl.hasAttribute('data-es') ? sectionTitleEl.getAttribute('data-es') : labelTranslations[sectionInfo.titleKey];
                if (sectionTitle) {
                    formData += `--- ${sectionTitle} ---\n`;
                }

                sectionElement.querySelectorAll('input, select, textarea').forEach(input => {
                    let fieldLabel = getFieldLabelSpanish(input);
                    let fieldValue = '';

                    if (input.type === 'radio') {
                        if (processedRadioGroups.has(input.name)) {
                            return; // Skip if this radio group has already been processed
                        }
                        const selectedRadio = document.querySelector(`input[name="${input.name}"]:checked`);
                        if (selectedRadio) {
                            const selectedOptionValue = selectedRadio.value;
                            fieldValue = labelTranslations[input.name] && labelTranslations[input.name][selectedOptionValue] ? labelTranslations[input.name][selectedOptionValue] : selectedOptionValue;
                        } else {
                            fieldValue = '(No seleccionado)';
                        }
                        processedRadioGroups.add(input.name);
                    } else if (input.tagName === 'SELECT') {
                        fieldValue = input.options[input.selectedIndex].text;
                    } else {
                        fieldValue = input.value;
                    }
                    
                    formData += `${fieldLabel}: ${fieldValue}\n`;
                });
                formData += '\n';
            });

            // --- Footer ---
            formData += getSpanishText('.form-footer') + '\n\n';

            // --- Instructions Section ---
            const instructionsSection = document.querySelector('.instruction-section');
            if (instructionsSection) {
                formData += `--- ${getSpanishText('.instruction-section .section-title')} ---\n`;
                
                formData += getSpanishText('.instruction-section .notes p.font-semibold.text-lg.mb-2') + '\n';
                
                const listItems = instructionsSection.querySelectorAll('.notes ul li');
                listItems.forEach(li => {
                    const strongSpan = li.querySelector('strong');
                    const contentSpan = li.querySelector('span');
                    let listItemText = '';

                    if (strongSpan && strongSpan.hasAttribute('data-es')) {
                        listItemText += strongSpan.getAttribute('data-es').trim() + ' ';
                    } else if (strongSpan) {
                         listItemText += strongSpan.textContent.trim() + ' '; // Fallback to current text if no data-es
                    }

                    if (contentSpan && contentSpan.hasAttribute('data-es')) {
                        listItemText += contentSpan.getAttribute('data-es').trim();
                    } else if (contentSpan) {
                        listItemText += contentSpan.textContent.trim(); // Fallback to current text if no data-es
                    }
                    if (listItemText) {
                        formData += `- ${listItemText}\n`;
                    }
                });

                const finalNote = instructionsSection.querySelector('.notes p.mt-4.font-bold.text-sm');
                if (finalNote && finalNote.hasAttribute('data-es')) {
                    formData += `\n${finalNote.getAttribute('data-es').trim()}\n`;
                }
            }


            const blob = new Blob([formData], { type: 'text/plain;charset=utf-8' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'Datos_Formulario_Nacimiento_Ciudadania_España.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(a.href);
        }
    </script>
</body>
</html>
